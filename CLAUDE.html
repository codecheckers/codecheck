<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CLAUDE.md • codecheck</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">codecheck</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.22.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/codecheck_overview.html">codecheck: Introduction to the codecheck package</a></li>
    <li><a class="dropdown-item" href="articles/codecheck_register.html">codecheck: Render the register</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/codecheckers/codecheck/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>CLAUDE.md</h1>
      <small class="dont-index">Source: <a href="https://github.com/codecheckers/codecheck/blob/master/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>

<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>The <code>codecheck</code> package is an R package that assists in conducting <a href="https://codecheck.org.uk/" class="external-link">CODECHECKs</a> - independent verification of computational research. It provides two main functions:</p>
<ol style="list-style-type: decimal"><li>
<strong>Workspace creation tools</strong> - Help researchers prepare CODECHECK workspaces with proper metadata and structure</li>
<li>
<strong>Register management tools</strong> - Render and maintain the <a href="https://codecheck.org.uk/register/" class="external-link">CODECHECK Register</a> which tracks all completed codechecks</li>
</ol></div>
<div class="section level2">
<h2 id="installation--development">Installation &amp; Development<a class="anchor" aria-label="anchor" href="#installation--development"></a></h2>
<p>Install the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"codecheckers/codecheck"</span><span class="op">)</span></span></code></pre></div>
<p>Run tests using <code>tinytest</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interactive testing</span></span>
<span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/run_test_dir.html" class="external-link">test_all</a></span><span class="op">(</span><span class="st">"/path/to/package"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or build, install, and test in a fresh environment</span></span>
<span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/build_install_test.html" class="external-link">build_install_test</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span></code></pre></div>
<p>The package uses GitHub Actions for CI/CD. Check <code>.github/workflows/R-CMD-check.yaml</code> for the automated testing setup.</p>
<div class="section level3">
<h3 id="changelog-management">Changelog Management<a class="anchor" aria-label="anchor" href="#changelog-management"></a></h3>
<p><strong>IMPORTANT</strong>: When making changes to the package, always update <code>NEWS.md</code> with: - A brief description of the change - For new features, document the user-facing functionality - For bug fixes, reference the issue or describe the problem solved - For breaking changes, clearly mark them as such</p>
<p>When bumping the version in <code>DESCRIPTION</code>, add a new section to <code>NEWS.md</code> with the version number and date. Follow the existing format with <code># codecheck X.Y.Z</code> headers.</p>
</div>
</div>
<div class="section level2">
<h2 id="core-architecture">Core Architecture<a class="anchor" aria-label="anchor" href="#core-architecture"></a></h2>
<div class="section level3">
<h3 id="id_1-workspace-creation-rcodecheckr">1. Workspace Creation (R/codecheck.R)<a class="anchor" aria-label="anchor" href="#id_1-workspace-creation-rcodecheckr"></a></h3>
<p><strong>Main entry point</strong>: <code><a href="reference/create_codecheck_files.html">create_codecheck_files()</a></code> creates the initial CODECHECK workspace including:</p>
<ul><li>A <code>codecheck.yml</code> file with required metadata (certificate ID, authors, manifest, etc.)</li>
<li>A <code>codecheck/</code> directory with report templates</li>
</ul><p><strong>Key functions</strong>:</p>
<ul><li>
<code><a href="reference/codecheck_metadata.html">codecheck_metadata()</a></code> - Load and parse <code>codecheck.yml</code>
</li>
<li>
<code><a href="reference/copy_manifest_files.html">copy_manifest_files()</a></code> - Copy output files specified in the manifest to the codecheck folder</li>
<li>
<code><a href="reference/validate_yaml_syntax.html">validate_yaml_syntax()</a></code> - Validate YAML syntax before parsing; checks if file is valid YAML; integrated into certificate template to prevent compilation with invalid YAML (R/configuration.R:184)</li>
<li>
<code><a href="reference/validate_codecheck_yml.html">validate_codecheck_yml()</a></code> - Validate that a codecheck.yml file meets the specification (R/configuration.R:348)</li>
<li>
<code><a href="reference/complete_codecheck_yml.html">complete_codecheck_yml()</a></code> - Analyze and complete codecheck.yml with missing fields; validates against specification; can add placeholders for mandatory and optional fields</li>
<li>
<code><a href="reference/validate_codecheck_yml_crossref.html">validate_codecheck_yml_crossref()</a></code> - Validate metadata against CrossRef; checks title, authors, and ORCID consistency; integrated into certificate template</li>
<li>
<code><a href="reference/get_certificate_from_github_issue.html">get_certificate_from_github_issue()</a></code> - Retrieve certificate identifier from GitHub issues by matching author names; searches codecheckers/register repository; supports open/closed/all issues (R/configuration.R:229)</li>
<li>
<code><a href="reference/is_placeholder_certificate.html">is_placeholder_certificate()</a></code> - Check if certificate ID is a placeholder; detects common placeholder patterns and template-like text</li>
<li>
<code><a href="reference/update_certificate_from_github.html">update_certificate_from_github()</a></code> - Automatically update certificate ID from GitHub; wraps <code><a href="reference/get_certificate_from_github_issue.html">get_certificate_from_github_issue()</a></code> with placeholder detection and file updating; integrated into certificate template</li>
</ul><p><strong>Lifecycle Journal automation</strong>: Functions for auto-populating metadata from Lifecycle Journal articles:</p>
<ul><li>
<code><a href="reference/get_lifecycle_metadata.html">get_lifecycle_metadata()</a></code> - Retrieve article metadata from CrossRef API using submission ID or DOI (prefix: <code>10.71240/lcyc.</code>)</li>
<li>
<code><a href="reference/update_codecheck_yml_from_lifecycle.html">update_codecheck_yml_from_lifecycle()</a></code> - Update local <code>codecheck.yml</code> with metadata; shows diff before applying changes; supports preview mode and selective field updates</li>
</ul><p><strong>External validation</strong>: Ensure consistency with published paper metadata and ORCID records:</p>
<ul><li>
<code><a href="reference/validate_codecheck_yml_crossref.html">validate_codecheck_yml_crossref()</a></code> - Validates paper metadata against CrossRef API; compares title and author information with CrossRef data</li>
<li>
<code><a href="reference/validate_codecheck_yml_orcid.html">validate_codecheck_yml_orcid()</a></code> - Validates author and codechecker names against ORCID API; queries ORCID records using rorcid package; compares names in ORCID records with local metadata</li>
<li>
<code><a href="reference/validate_contents_references.html">validate_contents_references()</a></code> - Comprehensive validation wrapper; runs both CrossRef and ORCID validations; provides unified summary; supports strict mode for certificate rendering</li>
</ul><p><strong>Zenodo integration</strong>: Functions for uploading certificates to Zenodo:</p>
<ul><li>
<code><a href="reference/get_or_create_zenodo_record.html">get_or_create_zenodo_record()</a></code> - Create or retrieve a Zenodo record; defaults to loading metadata from codecheck.yml in current directory</li>
<li>
<code><a href="reference/get_zenodo_record.html">get_zenodo_record()</a></code> - Retrieve existing Zenodo record; defaults to loading metadata from codecheck.yml in current directory</li>
<li>
<code><a href="reference/upload_zenodo_metadata.html">upload_zenodo_metadata()</a></code> - Upload metadata from codecheck.yml; defaults to loading from current directory</li>
<li>
<code><a href="reference/upload_zenodo_certificate.html">set_zenodo_certificate()</a></code> - Upload the PDF certificate</li>
<li>
<code><a href="reference/get_zenodo_id.html">get_zenodo_id()</a></code> - Extract Zenodo record number from DOI URL</li>
</ul></div>
<div class="section level3">
<h3 id="id_2-register-management-rregisterr">2. Register Management (R/register.R)<a class="anchor" aria-label="anchor" href="#id_2-register-management-rregisterr"></a></h3>
<p><strong>Main entry point</strong>: <code><a href="reference/register_render.html">register_render()</a></code> processes a CSV register file and generates multiple views:</p>
<ul><li>HTML pages for each certificate</li>
<li>Markdown summaries</li>
<li>JSON data files</li>
<li>Filtered views by venue, codechecker, etc.</li>
</ul><p><strong>Architecture flow</strong>:</p>
<ol style="list-style-type: decimal"><li>Load register CSV and config files (inst/extdata/config.R contains global CONFIG)</li>
<li>
<code><a href="reference/preprocess_register.html">preprocess_register()</a></code> enriches entries with remote codecheck.yml data (R/utils_preprocess_register.R)</li>
<li>Generate outputs:
<ul><li>
<code><a href="reference/render_cert_htmls.html">render_cert_htmls()</a></code> - HTML certificate pages (R/utils_render_cert_htmls.R)</li>
<li>
<code><a href="reference/create_filtered_reg_csvs.html">create_filtered_reg_csvs()</a></code> - CSV files filtered by venue/codechecker (R/utils_create_filtered_register_csvs.R)</li>
<li>
<code><a href="reference/create_register_files.html">create_register_files()</a></code> - Main register tables (R/utils_render_register_mds.R, R/utils_render_register_htmls.R, R/utils_render_register_json.R)</li>
<li>
<code><a href="reference/create_non_register_files.html">create_non_register_files()</a></code> - Lists of venues/codecheckers (R/utils_render_table_*.R)</li>
</ul></li>
</ol><p><strong>Configuration</strong>: <code>inst/extdata/config.R</code> defines a global <code>CONFIG</code> environment with:</p>
<ul><li>Table column widths and structures</li>
<li>URL patterns for different platforms (GitHub, OSF, GitLab, Zenodo)</li>
<li>Hyperlink templates</li>
<li>Venue and codechecker display settings</li>
</ul></div>
<div class="section level3">
<h3 id="id_3-remote-configuration-retrieval-rconfigurationr">3. Remote Configuration Retrieval (R/configuration.R)<a class="anchor" aria-label="anchor" href="#id_3-remote-configuration-retrieval-rconfigurationr"></a></h3>
<p><strong>Main entry point</strong>: <code><a href="reference/get_codecheck_yml.html">get_codecheck_yml()</a></code> fetches codecheck.yml from remote repositories.</p>
<p><strong>Multi-platform support</strong> via <code><a href="reference/parse_repository_spec.html">parse_repository_spec()</a></code>:</p>
<ul><li>
<code>github::org/repo</code> - GitHub repositories</li>
<li>
<code>osf::ABC12</code> - OSF projects (5-character IDs)</li>
<li>
<code>gitlab::project/repo</code> - GitLab.com projects</li>
<li>
<code>zenodo::1234567</code> - Zenodo records (7+ digit IDs)</li>
<li>
<code>zenodo-sandbox::1234567</code> - Zenodo Sandbox</li>
</ul><p>Each platform has dedicated retrieval functions (<code><a href="reference/get_codecheck_yml_github.html">get_codecheck_yml_github()</a></code>, etc.) and results are cached using <code><a href="https://rdrr.io/pkg/R.cache/man/addMemoization.html" class="external-link">R.cache::addMemoization()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="key-data-structures">Key Data Structures<a class="anchor" aria-label="anchor" href="#key-data-structures"></a></h2>
<div class="section level3">
<h3 id="codecheckyml-structure">codecheck.yml Structure<a class="anchor" aria-label="anchor" href="#codecheckyml-structure"></a></h3>
<p>The YAML configuration file must contain:</p>
<ul><li>
<code>certificate</code> - Pattern: NNNN-NNN (e.g., “2024-001”)</li>
<li>
<code>paper</code> - Title, authors (with name and optional ORCID), reference URL</li>
<li>
<code>codechecker</code> - Name and optional ORCID of checker(s)</li>
<li>
<code>manifest</code> - List of output files, each with <code>file</code> and <code>comment</code>
</li>
<li>
<code>report</code> - DOI for the Zenodo certificate</li>
<li>
<code>repository</code> - URL(s) to the code repository</li>
<li>
<code>check_time</code> - ISO 8601 timestamp</li>
</ul><p>See template at <code>inst/extdata/templates/codecheck.yml</code>.</p>
</div>
<div class="section level3">
<h3 id="register-csv-format">Register CSV Format<a class="anchor" aria-label="anchor" href="#register-csv-format"></a></h3>
<p>The register CSV contains columns:</p>
<ul><li>Certificate - ID (e.g., “2024-001”)</li>
<li>Repository - Platform-prefixed spec (e.g., “github::codecheckers/repo”)</li>
<li>Type - Venue category (journal, conference, community, institution)</li>
<li>Venue - Short venue name</li>
<li>Issue - GitHub issue number for the CODECHECK</li>
<li>Report - Zenodo DOI</li>
<li>Check date - ISO 8601 date</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="templates">Templates<a class="anchor" aria-label="anchor" href="#templates"></a></h2>
<p>Templates use Pandoc and Markdown for rendering and the <code>whisker</code> package for rendering specific parts of HTMLs using Mustache’s logicless templating. Templates are located in <code>inst/extdata/templates/</code>:</p>
<ul><li>
<code>cert/</code> - Certificate markdown and HTML templates</li>
<li>
<code>reg_tables/</code> - Register table templates</li>
<li>
<code>non_reg_tables/</code> - Venue/codechecker list templates</li>
<li>
<code>general/</code> - Shared HTML headers/footers</li>
</ul></div>
<div class="section level2">
<h2 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a></h2>
<ul><li>
<strong>GitHub API token</strong>: Set <code>GITHUB_PAT</code> environment variable to avoid rate limits when rendering the register</li>
<li>
<strong>Caching</strong>: Remote configurations are cached via <code>R.cache</code>. Use <code><a href="reference/register_clear_cache.html">register_clear_cache()</a></code> to reset</li>
<li>
<strong>ORCID format</strong>: Must be without URL prefix (NNNN-NNNN-NNNN-NNNX format)</li>
<li>
<strong>DOI validation</strong>: Uses <code><a href="https://rdrr.io/pkg/rorcid/man/check_dois.html" class="external-link">rorcid::check_dois()</a></code> and requires network access</li>
<li>
<strong>UTF-8 encoding</strong>: All YAML files should be UTF-8 encoded</li>
<li>
<strong>Date formats</strong>: Use ISO 8601 for all date/time fields</li>
<li>
<strong>Manifest files</strong>: Paths in the manifest are relative to the root of the repository</li>
<li>
<strong>Zenodo sandbox</strong>: Use <code>zenodo-sandbox::</code> prefix for testing uploads without affecting the main Zenodo repository</li>
<li>
<strong>Configuration updates</strong>: Update <code>inst/extdata/config.R</code> for changes in URL patterns, table structures, etc.</li>
<li>
<strong>Testing</strong>: Use <code>tinytest</code> for unit tests located in <code>inst/tinytest/</code>. Run tests with <code>tinytest::test_package("codecheck")</code> from the installed package or <code>tinytest::test_all(".")</code> from source.</li>
<li>
<strong>Documentation</strong>: Use <code>roxygen2</code> for function documentation</li>
<li>
<strong>Changelog</strong>: Always update <code>NEWS.md</code> when making changes. Each version should have its own section documenting new features, bug fixes, and breaking changes.</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephen Eglen, Daniel Nuest, Angelina Momin, Sam Langton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

